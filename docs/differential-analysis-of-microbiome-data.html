<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>5 Differential Analysis of Microbiome Data | IMAP: Integrated Microbiome Analysis Pipelines</title>
<meta name="author" content="Teresia Mrema-Buza">
<meta name="description" content="Differential abundance analysis is a fundamental technique in microbiome research used to identify features that exhibit significant differences in abundance across different biological conditions...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="5 Differential Analysis of Microbiome Data | IMAP: Integrated Microbiome Analysis Pipelines">
<meta property="og:type" content="book">
<meta property="og:url" content="https://tmbuza.github.io/imap-data-exploration/differential-analysis-of-microbiome-data.html">
<meta property="og:image" content="https://tmbuza.github.io/imap-data-exploration/images/planning.png">
<meta property="og:description" content="Differential abundance analysis is a fundamental technique in microbiome research used to identify features that exhibit significant differences in abundance across different biological conditions...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="5 Differential Analysis of Microbiome Data | IMAP: Integrated Microbiome Analysis Pipelines">
<meta name="twitter:description" content="Differential abundance analysis is a fundamental technique in microbiome research used to identify features that exhibit significant differences in abundance across different biological conditions...">
<meta name="twitter:image" content="https://tmbuza.github.io/imap-data-exploration/images/planning.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Sen-0.4.8/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=DM%20Mono&amp;display=swap" rel="stylesheet">
<link href="libs/Bitter-0.4.8/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="End-to-End Practical User Guides Using Integrated Approaches"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a>:
        <small class="text-muted">End-to-End Practical User Guides Using Integrated Approaches</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">IMAP-Part 08: Microbiome Data Exploration Guide</a></li>
<li class="book-part">DATA EXPLORATION</li>
<li><a class="" href="preface.html"><span class="header-section-number">1</span> Exploratory Data Analysis (EDA) of Microbiome Communities</a></li>
<li class="book-part">DEMO DATASET</li>
<li><a class="" href="demo-datasets.html"><span class="header-section-number">2</span> Microbiome Demo Datasets</a></li>
<li class="book-part">START EXPLORING</li>
<li><a class="" href="exploration-of-visualization-types.html"><span class="header-section-number">3</span> Exploration of Visualization Types</a></li>
<li class="book-part">BAR CHARTS</li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">4</span> Bar Plots</a></li>
<li class="book-part">DIFFERENTIAL ABUNDANCE</li>
<li><a class="active" href="differential-analysis-of-microbiome-data.html"><span class="header-section-number">5</span> Differential Analysis of Microbiome Data</a></li>
<li class="book-part">ORDINATION</li>
<li><a class="" href="ordination-plots.html"><span class="header-section-number">6</span> Ordination Plots</a></li>
<li class="book-part">RELATIONSHIP ANALYSIS</li>
<li><a class="" href="patterns-and-associations-analysis.html"><span class="header-section-number">7</span> Patterns and Associations Analysis</a></li>
<li class="book-part">PHYLOGENY ANALYSIS</li>
<li><a class="" href="phylogenetic-analysis.html"><span class="header-section-number">8</span> Phylogenetic Analysis</a></li>
<li class="book-part">STATISTICAL ANALYSIS</li>
<li><a class="" href="statistical-significance-analysis.html"><span class="header-section-number">10</span> Statistical Significance Analysis</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="imap-github-repos.html"><span class="header-section-number">A</span> IMAP GitHub Repos</a></li>
<li><a class="" href="data-exploration-rulegraph.html"><span class="header-section-number">B</span> Data Exploration Rulegraph</a></li>
<li><a class="" href="session-information.html"><span class="header-section-number">C</span> Session Information</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/tmbuza/imap-data-exploration.git">View book source <i class="fas fa-air-freshener"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="differential-analysis-of-microbiome-data" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Differential Analysis of Microbiome Data<a class="anchor" aria-label="anchor" href="#differential-analysis-of-microbiome-data"><i class="fas fa-link"></i></a>
</h1>
<p>Differential abundance analysis is a fundamental technique in microbiome research used to identify features that exhibit significant differences in abundance across different biological conditions or treatments. This analysis is crucial for understanding the dynamics of microbial communities and their response to various environmental factors. In this section, we will explore different methods for conducting differential abundance analysis using microbiome data.</p>
<div id="using-run_lefse-in-microbiomemaker-package" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Using run_lefse() in microbiomeMaker Package<a class="anchor" aria-label="anchor" href="#using-run_lefse-in-microbiomemaker-package"><i class="fas fa-link"></i></a>
</h2>
<p>The <code><a href="https://rdrr.io/pkg/microbiomeMarker/man/run_lefse.html">run_lefse()</a></code> function in the <code>microbiomeMaker</code> R package provides a convenient method for performing Differential Abundance Analysis on microbiome data. By leveraging the Linear Discriminant Analysis Effect Size (LEfSe) algorithm, <code><a href="https://rdrr.io/pkg/microbiomeMarker/man/run_lefse.html">run_lefse()</a></code> enables researchers to interpret the results in the context of biological class labels, uncovering important insights into microbial community dynamics.</p>
<p><strong>Dataset: dietswap</strong></p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yiluheihei/microbiomeMarker">microbiomeMarker</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run LEfSe analysis</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbiomeMarker/man/run_lefse.html">run_lefse</a></span><span class="op">(</span></span>
<span>  <span class="va">psextra_raw</span>,</span>
<span>  wilcoxon_cutoff <span class="op">=</span> <span class="fl">0.0001</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"nationality"</span>,</span>
<span>  taxa_rank <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span>  transform <span class="op">=</span> <span class="st">"log10p"</span>,</span>
<span>  kw_cutoff <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  multigrp_strat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lda_cutoff <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"nationality"</span>, color <span class="op">=</span> <span class="st">"rainbow"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02_explore_visual_types_files/figure-html/lefse_microbiomeMarker1-1.png" width="960"></div>
<p><strong>Dataset: caporaso</strong></p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yiluheihei/microbiomeMarker">microbiomeMarker</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ps_caporaso</span> <span class="op">&lt;-</span> <span class="va">ps_caporaso</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/tax_fix.html">tax_fix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbiomeMarker/man/run_lefse.html">run_lefse</a></span><span class="op">(</span></span>
<span>    <span class="va">ps_caporaso</span>, </span>
<span>    wilcoxon_cutoff <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"SampleType"</span>,</span>
<span>    taxa_rank <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span>    transform <span class="op">=</span> <span class="st">"log10p"</span>,</span>
<span>    kw_cutoff <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    multigrp_strat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    lda_cutoff <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/microbiomeMarker/man/plot_heatmap.html">plot_heatmap</a></span><span class="op">(</span>group <span class="op">=</span> <span class="st">"SampleType"</span>, color <span class="op">=</span> <span class="st">"rainbow"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02_explore_visual_types_files/figure-html/lefse_microbiomeMarker2-1.png" width="960"></div>
</div>
<div id="cladogram-on-kostic_crc-dataset" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Cladogram on kostic_crc dataset<a class="anchor" aria-label="anchor" href="#cladogram-on-kostic_crc-dataset"><i class="fas fa-link"></i></a>
</h2>
<p>Using plot_cladogram() from microbiomeMarker package</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yiluheihei/microbiomeMarker">microbiomeMarker</a></span><span class="op">)</span></span>
<span><span class="va">kostic_crc_small</span> <span class="op">&lt;-</span> <span class="fu">phyloseq</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/phyloseq/man/subset_taxa-methods.html">subset_taxa</a></span><span class="op">(</span></span>
<span>    <span class="va">ps_kostic_crc</span>,</span>
<span>    <span class="va">Phylum</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Firmicutes"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">mm_lefse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/microbiomeMarker/man/run_lefse.html">run_lefse</a></span><span class="op">(</span></span>
<span>    <span class="va">kostic_crc_small</span>,</span>
<span>    wilcoxon_cutoff <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    group <span class="op">=</span> <span class="st">"DIAGNOSIS"</span>,</span>
<span>    kw_cutoff <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>    multigrp_strat <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    lda_cutoff <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbiomeMarker/man/plot_cladogram.html">plot_cladogram</a></span><span class="op">(</span><span class="va">mm_lefse</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"darkgreen"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02_explore_visual_types_files/figure-html/ps_kostic_crc_cladogram-1.png" width="960"></div>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="bar-plots.html"><span class="header-section-number">4</span> Bar Plots</a></div>
<div class="next"><a href="ordination-plots.html"><span class="header-section-number">6</span> Ordination Plots</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#differential-analysis-of-microbiome-data"><span class="header-section-number">5</span> Differential Analysis of Microbiome Data</a></li>
<li><a class="nav-link" href="#using-run_lefse-in-microbiomemaker-package"><span class="header-section-number">5.1</span> Using run_lefse() in microbiomeMaker Package</a></li>
<li><a class="nav-link" href="#cladogram-on-kostic_crc-dataset"><span class="header-section-number">5.2</span> Cladogram on kostic_crc dataset</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/tmbuza/imap-data-exploration.git/blob/gh-pages/02_explore_visual_types.Rmd">View source <i class="fas fa-air-freshener"></i></a></li>
          <li><a id="book-edit" href="https://github.com/tmbuza/imap-data-exploration.git/edit/gh-pages/02_explore_visual_types.Rmd">Edit this page <i class="fas fa-air-freshener"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container">
    <div class="row">
      <div class="col-12 col-md-6 mt-3">
        <p><strong><u><a class="text-light" href="https://microbiome.complexdatainsights.com"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a></u></strong>: End-to-End Practical User Guides Using Integrated Approaches</p>
<br><p>Authored by Teresia Mrema-Buza, Last updated: <b>2024-04-18</b>.</p>
<br>
</div>
      <div class="col-12 col-md-6 mt-3">
        <p>Note: This practical guide was created using the <a class="text-light" href="https://bookdown.org/yihui/bookdown/">bookdown</a> R package, styled with the modern bs4_book format.</p>
      </div>

    </div>
  </div>
</footer>
</body>
</html>
