<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Patterns and Associations Analysis | IMAP: Integrated Microbiome Analysis Pipelines</title>
<meta name="author" content="Teresia Mrema-Buza">
<meta name="description" content="In this section, we will explore methods for analyzing patterns and associations within datasets. These methods are instrumental in uncovering relationships between variables, identifying...">
<meta name="generator" content="bookdown 0.37 with bs4_book()">
<meta property="og:title" content="7 Patterns and Associations Analysis | IMAP: Integrated Microbiome Analysis Pipelines">
<meta property="og:type" content="book">
<meta property="og:url" content="https://tmbuza.github.io/imap-data-exploration/patterns-and-associations-analysis.html">
<meta property="og:image" content="https://tmbuza.github.io/imap-data-exploration/images/planning.png">
<meta property="og:description" content="In this section, we will explore methods for analyzing patterns and associations within datasets. These methods are instrumental in uncovering relationships between variables, identifying...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Patterns and Associations Analysis | IMAP: Integrated Microbiome Analysis Pipelines">
<meta name="twitter:description" content="In this section, we will explore methods for analyzing patterns and associations within datasets. These methods are instrumental in uncovering relationships between variables, identifying...">
<meta name="twitter:image" content="https://tmbuza.github.io/imap-data-exploration/images/planning.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Sen-0.4.8/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=DM%20Mono&amp;display=swap" rel="stylesheet">
<link href="libs/Bitter-0.4.8/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.6.1/transition.js"></script><script src="libs/bs3compat-0.6.1/tabs.js"></script><script src="libs/bs3compat-0.6.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="End-to-End Practical User Guides Using Integrated Approaches"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a>:
        <small class="text-muted">End-to-End Practical User Guides Using Integrated Approaches</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">IMAP-Part 08: Microbiome Data Exploration Guide</a></li>
<li class="book-part">DATA EXPLORATION</li>
<li><a class="" href="preface.html"><span class="header-section-number">1</span> Exploratory Data Analysis (EDA) of Microbiome Communities</a></li>
<li class="book-part">VISUALIZATION TYPES</li>
<li><a class="" href="visual-types.html"><span class="header-section-number">2</span> Type of Visualization of Microbiome Data</a></li>
<li class="book-part">START EXPLORING</li>
<li><a class="" href="exploration-of-visualization-types.html"><span class="header-section-number">3</span> Exploration of Visualization Types</a></li>
<li class="book-part">BAR CHARTS</li>
<li><a class="" href="bar-plots.html"><span class="header-section-number">4</span> Bar Plots</a></li>
<li class="book-part">DIFFERENTIAL ABUNDANCE</li>
<li><a class="" href="differential-analysis-of-microbiome-data.html"><span class="header-section-number">5</span> Differential Analysis of Microbiome Data</a></li>
<li class="book-part">ORDINATION</li>
<li><a class="" href="ordination-plots.html"><span class="header-section-number">6</span> Ordination Plots</a></li>
<li class="book-part">RELATIONSHIP ANALYSIS</li>
<li><a class="active" href="patterns-and-associations-analysis.html"><span class="header-section-number">7</span> Patterns and Associations Analysis</a></li>
<li class="book-part">PHYLOGENY ANALYSIS</li>
<li><a class="" href="phylogenetic-analysis.html"><span class="header-section-number">8</span> Phylogenetic Analysis</a></li>
<li class="book-part">STATISTICAL ANALYSIS</li>
<li><a class="" href="statistical-significance-analysis.html"><span class="header-section-number">10</span> Statistical Significance Analysis</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="imap-github-repos.html"><span class="header-section-number">A</span> IMAP GitHub Repos</a></li>
<li><a class="" href="data-exploration-rulegraph.html"><span class="header-section-number">B</span> Data Exploration Rulegraph</a></li>
<li><a class="" href="session-information.html"><span class="header-section-number">C</span> Session Information</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/tmbuza/imap-data-exploration.git">View book source <i class="fas fa-air-freshener"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="patterns-and-associations-analysis" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Patterns and Associations Analysis<a class="anchor" aria-label="anchor" href="#patterns-and-associations-analysis"><i class="fas fa-link"></i></a>
</h1>
<p>In this section, we will explore methods for analyzing patterns and associations within datasets. These methods are instrumental in uncovering relationships between variables, identifying underlying patterns, and elucidating complex structures within the data. Specifically, we will discuss correlation analysis, heatmap visualization, hierarchical clustering, and other techniques for exploring patterns and associations in various types of datasets.</p>
<div id="correlation-analysis-and-visualization" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Correlation analysis and visualization<a class="anchor" aria-label="anchor" href="#correlation-analysis-and-visualization"><i class="fas fa-link"></i></a>
</h2>
<p>Correlation analysis quantifies the strength and direction of the linear relationship between two continuous variables. It helps in understanding how variables are related to each other and can identify potential associations or dependencies within the data. Heatmap visualization is commonly integrated with correlation analysis to visually represent correlation matrices, allowing for the identification of patterns and relationships between variables.</p>
<div id="pearson-correlation-heatmap-with-microviz-package" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Pearson Correlation Heatmap with microViz Package<a class="anchor" aria-label="anchor" href="#pearson-correlation-heatmap-with-microviz-package"><i class="fas fa-link"></i></a>
</h3>
<p>In this section, we utilize the cor_heatmap function available in the microViz package to generate a heatmap visualizing Pearson correlation coefficients between variables. This technique allows for the exploration of relationships and patterns within the data, providing insights into the strength and direction of linear associations between variables.</p>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps_extra</span> <span class="op">&lt;-</span> <span class="va">ps_dietswap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://david-barnett.github.io/microViz/reference/tax_transform.html">tax_transform</a></span><span class="op">(</span></span>
<span>  trans <span class="op">=</span> <span class="st">"clr"</span>,</span>
<span>  rank <span class="op">=</span> <span class="st">"Genus"</span>,</span>
<span>  keep_counts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  zero_replace <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  add <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  transformation <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://dx.plos.org/10.1371/journal.pone.0061217">phyloseq</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://david-barnett.github.io/microViz">microViz</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set up the data with numerical variables and filter to top taxa</span></span>
<span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="va">ps_dietswap</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/ps_mutate.html">ps_mutate</a></span><span class="op">(</span></span>
<span>    bmi <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span><span class="va">bmi_group</span>, obese <span class="op">=</span> <span class="fl">3</span>, overweight <span class="op">=</span> <span class="fl">2</span>, lean <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    female <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">sex</span> <span class="op">==</span> <span class="st">"female"</span>, true <span class="op">=</span> <span class="fl">1</span>, false <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>    african <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="va">nationality</span> <span class="op">==</span> <span class="st">"AFR"</span>, true <span class="op">=</span> <span class="fl">1</span>, false <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/tax_filter.html">tax_filter</a></span><span class="op">(</span></span>
<span>    tax_level <span class="op">=</span> <span class="st">"Genus"</span>, min_prevalence <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span>, min_sample_abundance <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">10</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/tax_transform.html">tax_transform</a></span><span class="op">(</span><span class="st">"identity"</span>, rank <span class="op">=</span> <span class="st">"Genus"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Randomly select 30 taxa from the 50 most abundant taxa (just for demo)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">top_taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/tax_top.html">tax_top</a></span><span class="op">(</span><span class="va">ps_dietswap</span>, n <span class="op">=</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="va">sum</span>, rank <span class="op">=</span> <span class="st">"unique"</span>, use_counts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://david-barnett.github.io/microViz/reference/tax_top.html">tax_top</a></span><span class="op">(</span><span class="va">ps_dietswap</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Clean the data and draw the correlation heatmap </span></span>
<span><span class="fu"><a href="https://david-barnett.github.io/microViz/reference/cor_heatmap.html">cor_heatmap</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ps</span>, </span>
<span>  taxa <span class="op">=</span> <span class="va">taxa</span>,</span>
<span>  taxon_renamer <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">" [ae]t rel."</span><span class="op">)</span>,</span>
<span>  tax_anno <span class="op">=</span> <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/taxAnnotation.html">taxAnnotation</a></span><span class="op">(</span></span>
<span>    Prev. <span class="op">=</span> <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/anno_tax_prev.html">anno_tax_prev</a></span><span class="op">(</span>undetected <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>,</span>
<span>    Log2 <span class="op">=</span> <span class="fu"><a href="https://david-barnett.github.io/microViz/reference/anno_tax_box.html">anno_tax_box</a></span><span class="op">(</span>undetected <span class="op">=</span> <span class="fl">50</span>, trans <span class="op">=</span> <span class="st">"log2"</span>, zero_replace <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="02_explore_visual_types_files/figure-html/unnamed-chunk-8-1.png" width="672"></div>
<blockquote>
<p>Note: The parameter min_prevalence = 0.1 is set, equivalent to approximately 23 out of 222 samples. This value may vary depending on the dataset. Adjust as necessary.</p>
</blockquote>
</div>
</div>
<div id="hierarchical-clustering" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Hierarchical clustering<a class="anchor" aria-label="anchor" href="#hierarchical-clustering"><i class="fas fa-link"></i></a>
</h2>
<p>Hierarchical clustering is a method for grouping similar observations or variables together based on their similarity or dissimilarity. It creates a hierarchical tree-like structure (dendrogram) that illustrates the relationships between clusters, allowing for the identification of natural groupings or patterns within the data.</p>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="ordination-plots.html"><span class="header-section-number">6</span> Ordination Plots</a></div>
<div class="next"><a href="phylogenetic-analysis.html"><span class="header-section-number">8</span> Phylogenetic Analysis</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#patterns-and-associations-analysis"><span class="header-section-number">7</span> Patterns and Associations Analysis</a></li>
<li>
<a class="nav-link" href="#correlation-analysis-and-visualization"><span class="header-section-number">7.1</span> Correlation analysis and visualization</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#pearson-correlation-heatmap-with-microviz-package"><span class="header-section-number">7.1.1</span> Pearson Correlation Heatmap with microViz Package</a></li></ul>
</li>
<li><a class="nav-link" href="#hierarchical-clustering"><span class="header-section-number">7.2</span> Hierarchical clustering</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/tmbuza/imap-data-exploration.git/blob/gh-pages/02_explore_visual_types.Rmd">View source <i class="fas fa-air-freshener"></i></a></li>
          <li><a id="book-edit" href="https://github.com/tmbuza/imap-data-exploration.git/edit/gh-pages/02_explore_visual_types.Rmd">Edit this page <i class="fas fa-air-freshener"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container">
    <div class="row">
      <div class="col-12 col-md-6 mt-3">
        <p><strong><u><a class="text-light" href="https://microbiome.complexdatainsights.com"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a></u></strong>: End-to-End Practical User Guides Using Integrated Approaches</p>
<br><p>Authored by Teresia Mrema-Buza, Last updated: <b>2024-04-16</b>.</p>
<br>
</div>
      <div class="col-12 col-md-6 mt-3">
        <p>Note: This practical guide was created using the <a class="text-light" href="https://bookdown.org/yihui/bookdown/">bookdown</a> R package, styled with the modern bs4_book format.</p>
      </div>

    </div>
  </div>
</footer>
</body>
</html>
